<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>ballz</title>
	<script src="inc/jquery.min.js"></script>
	<script src="inc/two.min.js"></script>
	<style type="text/css">
		#stage {
			width: 400px;
			height: 400px;
			margin-left: auto;
			margin-right: auto;
			margin-top: 100px;
			border: 5px solid gray;
		}
	</style>
</head>

<body>

<div id="stage"></div>

<script type="text/javascript">

var ws, two, circle;

function log(message) {
	t = new Date();

	console.log("[" + t.getHours() + ":" +  t.getMinutes() + 
				":" + t.getSeconds() + "] " + message + "\n");
}

function send(message) {
	log(">> " + message);
	ws.send(message);
}

function receive(message){
	log("<< " + message);
	updatePos(message.split(','));
}

function updatePos(newPos){ // x, y , r
	circle.translation.set(newPos[0], newPos[1]);
	circle.scale = newPos[2]/20;

	two.update;
}

function init(){
	if ("WebSocket" in window) {
		ws = new WebSocket("ws://localhost:8989");

		ws.onopen = function() {
			log("websocket opened.");
		};

		ws.onmessage = function(evt) {
			receive(evt.data);
		};

		ws.onclose = function() {
			log("websocket closed.");
		};

	} else {
		alert("Websockets not supported!");
		return;
	}

	two = new Two({width: 400, height: 400}).appendTo($('#stage')[0]);

	//makeCircle(x, y, radius);
	circle = two.makeCircle(50, 50, 20);
	circle.fill = 'red';
	circle.stroke = 'orangered';
	circle.linewidth = 2;

	two.update();
}

init();

</script>

</body>

</html>
